import java.util.*;

class Pair {
    int r;
    int c;

    Pair(int r, int c) {
        this.r = r;
        this.c = c;
    }
}

class Solution {

    int[][] graph;
    boolean[] visited;
    int n;

    int bfs(int i, Set<Integer> initialSet) {

        Queue<Integer> q = new LinkedList<>();
        q.add(i);
        visited[i] = true;
        int count = 0;
        int initialCount = 0;

        while (!q.isEmpty()) {

            int idx = q.poll();
            count++;
            if (initialSet.contains(idx)) {
                initialCount++;
            }

            for (int j = 0; j < n; j++) {
                if (graph[idx][j] == 1 && !visited[j]) {
                    visited[j] = true;
                    q.add(j);   
                }
            }
        }

        return initialCount == 1 ? count : 0;
    }

    public int minMalwareSpread(int[][] graph, int[] initial) {

        this.graph = graph;
        this.n = graph.length;
        Arrays.sort(initial);
        Set<Integer> initialSet = new HashSet<>();
        for (int x : initial) {
            initialSet.add(x);
        }

        int max = 0;
        int result = Integer.MAX_VALUE;
        visited = new boolean[n];
        
        for (int i = 0; i < initial.length; i++) {
            int idx = initial[i];
            if (!visited[idx]) {
                int count = bfs(idx, initialSet);
                if (count > max || (count == max && idx < result)) {
                    max = count;
                    result = idx;
                }
            }
        }

        return result;
    }
}